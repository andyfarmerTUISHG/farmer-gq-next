"use client";

import Link from "next/link";
import { useState } from "react";
import { IoClose, IoMenu } from "react-icons/io5";

import { resolveHref } from "@/sanity/lib/utils";

export default function MenuLayout({ data }) {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const menuItems = data?.menuItems || [];

  const toggleMenu = () => setIsMenuOpen(!isMenuOpen);

  return (
    <div className="bg-primary hover:fill-primrary-400 top-0 z-50 w-full py-0 text-white">
      <div className=" ">
        <div className="container flex items-center justify-between">
          <div>
            <Link href="/" className="block w-24 lg:w-48">
              <div className="hover:fill-primrary-400 fill-white transition-colors">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0.352 -0.187 1280 600"
                >
                  <path d="M516.19 177h-18.659l17.082-32.587h57.816l58.867 187.64h-45.202l-10.512-37.58-10.249.788h-36.529l-8.935-.788-10.775 37.58h-42.311zm49.144 81.731-17.345-62.546-18.396 62.546h35.741zM660.468 177h-24.966l17.082-32.85h43.099l62.284 103.02 1.577 4.468v-107.49h40.997v187.9h-34.952l-63.072-103.81-1.314-3.942v107.75h-40.734v-155.05zm180.54-31.273c8.234-1.051 16.469-1.883 24.703-2.497s17.082-.92 26.543-.92c32.937 0 57.992 8.016 75.161 24.047 17.169 16.03 25.754 40.603 25.754 73.715 0 32.937-8.76 56.983-26.28 72.139-17.52 15.156-43.449 22.732-77.789 22.732-8.41 0-16.469-.263-24.178-.789a408.46 408.46 0 0 1-23.915-2.365v-186.06zm43.099 150.85c8.585.876 16.732.876 24.44 0s14.497-3.329 20.367-7.359c5.87-4.03 10.512-10.03 13.928-18.002 3.416-7.972 5.125-18.615 5.125-31.93 0-11.739-1.358-21.375-4.074-28.908-2.715-7.533-6.394-13.534-11.038-18.002-4.643-4.467-9.986-7.577-16.03-9.33-6.045-1.751-12.397-2.627-19.054-2.627h-6.438l-7.227.526v115.63zm169.51-32.324-2.497-4.993-6.701-13.534-9.46-19.316-10.776-22.075c-8.585-17.52-18.396-37.58-29.434-60.181h47.304l33.901 77.263a6169.906 6169.906 0 0 0 16.82-38.632c2.102-4.73 4.16-9.417 6.175-14.06 2.015-4.643 3.81-8.804 5.387-12.483 1.577-3.68 2.847-6.614 3.811-8.804l1.445-3.285h45.99l-58.867 120.36v67.802h-43.099V264.25z" />
                  <path d="M463.61 380.52h65.508c-1.141 4.15-2.23 7.832-3.268 11.048a821.587 821.587 0 0 1-2.334 7.469c-.726 2.282-1.14 3.423-1.245 3.423h-33.61l.312 3.423v19.139h31.43v22.251h-31.43v44.346H463.61v-111.1zm93.982 19.294h-11.048l10.114-19.294h34.232l34.854 111.1h-26.763l-6.224-22.251-6.068.467H565.06l-5.29-.467-6.38 22.251h-25.052zm29.097 48.392-10.27-37.033-10.892 37.033h21.162zm51.97-66.908c4.98-.622 9.543-1.115 13.693-1.478s8.558-.545 13.226-.545c5.705 0 11.385.545 17.038 1.634 5.653 1.09 10.71 2.982 15.171 5.68 4.46 2.696 8.066 6.327 10.814 10.891 2.749 4.565 4.123 10.373 4.123 17.427 0 4.046-.544 7.676-1.633 10.892s-2.438 6.043-4.046 8.48c-1.608 2.438-3.397 4.565-5.368 6.38-1.971 1.815-3.89 3.346-5.757 4.59l-.778.467 2.1 3.423 5.135 8.558 6.613 11.048 6.613 10.97 4.98 8.48 1.944 3.268h-28.475l-29.408-51.192v51.348H638.66V381.3zm25.985 58.039 5.446-2.49c1.349-.622 2.956-1.4 4.824-2.334 1.867-.933 3.682-2.152 5.446-3.656 1.763-1.504 3.267-3.294 4.512-5.368 1.245-2.075 1.867-4.616 1.867-7.625 0-3.216-.467-5.887-1.4-8.013-.934-2.127-2.23-3.838-3.89-5.135-1.66-1.297-3.605-2.23-5.835-2.8-2.23-.571-4.642-.857-7.236-.857h-1.789l-1.945.156v38.122zm73.288-58.817h26.608l23.651 57.883 1.79-4.279 4.434-10.659 5.68-13.926 5.679-14.004 4.357-10.736 1.711-4.279h24.896l5.446 111.1H816.51l-1.089-64.885-18.205 42.323h-18.828l-18.828-42.323-1.712 64.885H733.73zm124.95-.156h65.508a405.637 405.637 0 0 1-3.112 11.203 750.916 750.916 0 0 0-3.112 10.892h-34.232c0 .415.051 1.012.155 1.79.104.778.156 1.374.156 1.79v16.337h31.43v22.251h-31.43v21.317l-.311 3.579h41.078v22.095h-66.13v-111.25zm82.624.934c4.98-.622 9.543-1.115 13.693-1.478s8.558-.545 13.226-.545a89.87 89.87 0 0 1 17.038 1.634c5.653 1.09 10.71 2.982 15.171 5.68 4.46 2.696 8.066 6.327 10.814 10.891 2.749 4.565 4.123 10.373 4.123 17.427 0 4.046-.544 7.676-1.633 10.892s-2.438 6.043-4.046 8.48c-1.608 2.438-3.397 4.565-5.368 6.38-1.971 1.815-3.89 3.346-5.757 4.59l-.778.467 2.1 3.423 5.135 8.558 6.613 11.048 6.613 10.97 4.98 8.48 1.944 3.268H1000.9l-29.408-51.192v51.348h-25.985V381.3zm25.985 58.039 5.446-2.49c1.349-.622 2.956-1.4 4.824-2.334 1.867-.933 3.682-2.152 5.446-3.656 1.763-1.504 3.267-3.294 4.512-5.368 1.245-2.075 1.867-4.616 1.867-7.625 0-3.216-.467-5.887-1.4-8.013-.934-2.127-2.23-3.838-3.89-5.135-1.66-1.297-3.605-2.23-5.835-2.8-2.23-.571-4.642-.857-7.236-.857h-1.789l-1.945.156v38.122z" />
                  <path d="M438.26 141.87c0-22.923-18.645-41.56-41.564-41.56s-41.564 18.637-41.564 41.56c0 20.066 14.304 36.856 33.249 40.718v63.301l-99.75 78.372v-75.172c18.953-3.866 33.253-20.652 33.253-40.718 0-22.923-18.649-41.564-41.564-41.564s-41.564 18.641-41.564 41.564c0 20.066 14.3 36.852 33.249 40.718v75.172l-99.75-78.372v-63.301c18.949-3.862 33.249-20.652 33.249-40.718.004-22.923-18.641-41.56-41.556-41.56-22.919 0-41.564 18.637-41.564 41.56 0 20.066 14.304 36.856 33.249 40.718v71.389l116.38 91.423v71.628c-18.949 3.846-33.249 20.652-33.249 40.718 0 22.907 18.645 41.564 41.564 41.564s41.56-18.657 41.56-41.564c0-20.066-14.304-36.872-33.249-40.718V345.4l116.38-91.423v-71.389c18.949-3.862 33.249-20.652 33.249-40.718zm-299.25 0c0-13.75 11.184-24.938 24.938-24.938 13.75 0 24.938 11.188 24.938 24.938 0 13.75-11.188 24.938-24.938 24.938-13.754 0-24.938-11.188-24.938-24.938zm257.69 24.938c-13.754 0-24.938-11.188-24.938-24.938 0-13.75 11.184-24.938 24.938-24.938 13.75 0 24.938 11.188 24.938 24.938 0 13.75-11.184 24.938-24.938 24.938z" />
                </svg>
              </div>
            </Link>
          </div>
          <div className="hidden lg:block">
            <ul className="flex items-center">
              {menuItems.map((item, key) => {
                // destructring values of menuItem
                let { _type, slug, title, url } = item;
                if (_type === "sitelinks") {
                  slug = url;
                }
                let link = item.name ? item.name : title;
                const href = resolveHref(_type, slug);
                if (!href) return null;

                return (
                  <li key={key} className="group pl-6">
                    <Link
                      href={href}
                      className={`font-header cursor-pointer pt-0.5 font-semibold uppercase ${
                        item._type === "home"
                          ? "text-white"
                          : "text-white/90 hover:text-white"
                      }`}
                    >
                      {link}
                    </Link>
                    <span className="group-hover:bg-yellow block h-0.5 w-full bg-transparent"></span>
                  </li>
                );
              })}
            </ul>
          </div>
          <div className="block lg:hidden">
            <button onClick={toggleMenu}>
              <IoMenu size={40} color="white" />
            </button>
          </div>
        </div>
      </div>
      {/* SideBar Menu */}
      <div
        className={`bg-payne/90 fixed inset-0 z-70 min-h-screen transition-opacity lg:hidden ${
          isMenuOpen
            ? "pointer-events-auto opacity-100"
            : "pointer-events-none opacity-0"
        }`}
      >
        <div className="bg-primary absolute right-0 min-h-screen w-2/3 px-8 py-4 shadow md:w-1/3">
          <button
            onClick={toggleMenu}
            className="absolute top-0 right-0 mt-4 mr-4 cursor-pointer"
          >
            <IoClose size={40} color="white" />
          </button>
          <ul className="mt-8 flex flex-col">
            {menuItems.map((item, key) => {
              // destructring values of menuItem
              let { _type, slug, title, url } = item;
              if (_type === "sitelinks") {
                slug = url;
              }
              let link = item.name ? item.name : title;
              const href = resolveHref(_type, slug);
              if (!href) return null;

              return (
                <li key={key} className="py-2">
                  <Link
                    href={href}
                    className={`font-header block w-full cursor-pointer pt-0.5 font-semibold uppercase ${
                      item._type === "home"
                        ? "text-white"
                        : "text-white/90 hover:text-white"
                    }`}
                    onClick={toggleMenu}
                  >
                    {link}
                  </Link>
                </li>
              );
            })}
          </ul>
        </div>
      </div>
    </div>
  );
}
